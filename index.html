<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spelarschema 5v5</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 500px; margin: auto; }
    h1 { text-align: center; }
    input, select, button { margin: 5px 0; padding: 8px; width: 100%; }
    .period { margin-top: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>Spelarschema</h1>

  <label for="mode">Välj typ:</label>
  <select id="mode" onchange="showModeOptions()">
    <option value="match">Match</option>
    <option value="turnering">Turnering</option>
  </select>

  <div id="options">
    <label for="matches">Antal matcher:</label>
    <input type="number" id="matches" value="1" min="1">
    <label for="periods">Antal perioder per match:</label>
    <input type="number" id="periods" value="3" min="1">
    <label for="periodLength">Periodlängd (minuter):</label>
    <input type="number" id="periodLength" value="10" min="1">
    <label for="numPlayers">Antal spelare i truppen:</label>
    <input type="number" id="numPlayers" value="8" min="5">
  </div>

  <div id="players"></div>
  <button onclick="generateSchedule()">Skapa schema</button>

  <div id="schedule"></div>

  <script>
    const playersDiv = document.getElementById("players");
    let playerInputs = [];

    function showModeOptions() {
      const mode = document.getElementById("mode").value;
      document.getElementById("matches").parentElement.style.display = mode === 'turnering' ? 'block' : 'none';
    }

    function createPlayerInputs() {
      playersDiv.innerHTML = '';
      playerInputs = [];
      const num = parseInt(document.getElementById("numPlayers").value);
      for (let i = 0; i < num; i++) {
        let input = document.createElement("input");
        input.placeholder = `Spelare ${i+1}`;
        input.id = `p${i}`;
        playersDiv.appendChild(input);
        playerInputs.push(input);
      }
    }

    document.getElementById("numPlayers").addEventListener('input', createPlayerInputs);
    createPlayerInputs();

    function generateSchedule() {
      const numPlayers = parseInt(document.getElementById("numPlayers").value);
      const periods = parseInt(document.getElementById("periods").value);
      const periodLength = parseInt(document.getElementById("periodLength").value);
      const mode = document.getElementById("mode").value;
      const matches = mode === 'turnering' ? parseInt(document.getElementById("matches").value) : 1;

      const players = playerInputs.map(input => input.value || input.placeholder);
      const scheduleDiv = document.getElementById("schedule");
      scheduleDiv.innerHTML = '';

      let playTime = new Array(numPlayers).fill(0);

      for (let m = 0; m < matches; m++) {
        let matchDiv = document.createElement("div");
        matchDiv.innerHTML = `<h2>Match ${m+1}</h2>`;

        for (let p = 0; p < periods; p++) {
          // Sortera spelare efter minst speltid för jämn rotation
          let sorted = players.map((name, idx) => ({name, idx, time: playTime[idx]}))
                              .sort((a,b) => a.time - b.time);
          const onField = sorted.slice(0,5).map(s => s.idx);
          const offField = sorted.slice(5).map(s => s.idx);
          onField.forEach(i => playTime[i] += periodLength);

          let periodDiv = document.createElement("div");
          periodDiv.className = "period";
          periodDiv.innerHTML = `<strong>Period ${p+1} (${periodLength} min):</strong><br>
                                 På plan: ${onField.map(i=>players[i]).join(", ")}<br>
                                 Vilar: ${offField.map(i=>players[i]).join(", ")}`;
          matchDiv.appendChild(periodDiv);
        }

        scheduleDiv.appendChild(matchDiv);
      }
    }
  </script>
</body>
</html>
